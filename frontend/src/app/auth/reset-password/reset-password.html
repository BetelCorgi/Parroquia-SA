<section class="auth-shell">
  <div class="card">
    <h1 class="title">Restablecer contraseña</h1>
    <p class="sub">Cree una nueva contraseña segura.</p>

    <div *ngIf="error" class="error">{{ error }}</div>

    <form *ngIf="!error" [formGroup]="form" (ngSubmit)="submit()" class="form">
      <label>
        <span>Nueva contraseña</span>
        <input [type]="'password'" formControlName="password" placeholder="••••••••">
      </label>

      <!-- checklist de seguridad -->
    <ul class="rules">
        <li [class.ok]="f.password.value?.length >= 8">Mínimo 8 dígitos</li>
        <li [class.ok]="hasUppercase()">Mayúsculas</li>
        <li [class.ok]="hasLowercase()">Minúsculas</li>
        <li [class.ok]="hasNumber()">Números</li>
        <li [class.ok]="hasSpecial()">Un carácter especial</li>
    </ul>

      <label>
        <span>Confirmar contraseña</span>
        <input [type]="'password'" formControlName="confirm" placeholder="Repita su contraseña">
        <small class="msg" *ngIf="form.touched && form.errors?.['mismatch']">Las contraseñas no coinciden.</small>
      </label>

      <p class="success" *ngIf="success">{{ success }}</p>

      <button type="submit" class="btn-primary">Actualizar contraseña</button>
      <button type="button" class="btn-link" (click)="goLogin()">Ingresar</button>
    </form>
  </div>
</section>
